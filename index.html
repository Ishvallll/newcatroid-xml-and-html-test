<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>

<!-- üö´ DESABILITA ZOOM -->
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>

<title>XML</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: #000;
  overflow: hidden;

  /* üö´ zoom / gesture */
  touch-action: none;
  overscroll-behavior: none;
}

#stage {
  position: relative;
  width: 100%;
  height: 100%;
  background: #000;
}

.sprite {
  position: absolute;
  image-rendering: pixelated;
  pointer-events: none;
}
</style>
</head>

<body>
<div id="stage"></div>

<script>
// ===============================
// UTIL
// ===============================
function resolveAssetName(name) {
  if (!name) return null;
  if (name.endsWith('.gif.png')) {
    return name.replace(/\.gif\.png$/, '.gif');
  }
  return name;
}

// ===============================
// LOAD XML
// ===============================
async function loadGame(xmlPath = 'game.xml') {
  const stage = document.getElementById('stage');

  let xmlText;
  try {
    const res = await fetch(xmlPath);
    if (!res.ok) throw new Error('XML n√£o encontrado');
    xmlText = await res.text();
  } catch (e) {
    console.warn('‚ö†Ô∏è game.xml n√£o carregado:', e.message);
    return;
  }

  const parser = new DOMParser();
  const xml = parser.parseFromString(xmlText, 'application/xml');

  const sprites = xml.querySelectorAll('sprite');

  sprites.forEach(s => {
    const rawSrc = s.getAttribute('src');
    if (!rawSrc) return;

    const src = resolveAssetName(rawSrc);
    const img = new Image();
    img.className = 'sprite';

    // posi√ß√£o
    img.style.left = (s.getAttribute('x') || 0) + 'px';
    img.style.top  = (s.getAttribute('y') || 0) + 'px';
    img.style.zIndex = s.getAttribute('z') || 1;

    // üö´ SE A IMAGEM N√ÉO EXISTIR ‚Üí IGNORA
    img.onerror = () => {
      console.warn('‚ö†Ô∏è Asset ignorado:', src);
      img.remove();
    };

    img.src = 'assets/' + src;
    stage.appendChild(img);
  });
}

// ===============================
// START
// ===============================
loadGame();
</script>
</body>
</html>
